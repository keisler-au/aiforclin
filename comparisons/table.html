<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Product Comparison Tool</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
  <style>
    body{ font-family:'Inter',sans-serif;}
    .transition-all-smooth{ transition: all .2s ease-in-out; }
    .comparison-placeholder{ border:2px dashed #d1d5db; color:#6b7280; min-height:180px; }
    .sticky-header{ position: sticky; top: 0; background: white; z-index: 10; box-shadow: inset 0 -1px 0 0 #e5e7eb; }
    dialog::backdrop{ background: rgba(0,0,0,.4); }
  </style>
</head>
<body class="bg-gray-50 text-gray-800">
  <div class="container mx-auto p-4 sm:p-6 lg:p-8">
    <header class="text-center mb-8">
      <h1 class="text-4xl font-bold text-gray-900">Compare Our Plans</h1>
      <p class="mt-2 text-lg text-gray-600">Select up to 3 plans to see a side-by-side comparison.</p>
    </header>

    <main id="main" class="space-y-12">
      <!-- Plan selection + filters -->
      <section aria-labelledby="select-plans-heading">
        <div class="flex items-start sm:items-center justify-between gap-3 mb-3">
          <div>
            <h2 id="select-plans-heading" class="text-xl font-semibold">Select plans to compare</h2>

            <!-- Active filter chips summary -->
            <nav aria-label="Active filters">
              <ul id="active-chips" class="mt-2 flex flex-wrap gap-2"></ul>
            </nav>
          </div>

          <!-- Filters toolbar -->
          <div class="flex items-center gap-3">
            <p id="match-pill" class="hidden sm:inline-flex items-center gap-2 text-sm text-gray-600" aria-live="polite">
              <span id="match-count" class="font-semibold">0</span> matches
            </p>

            <button id="filter-btn" type="button" aria-haspopup="dialog" aria-controls="filter-dialog" aria-expanded="false"
              class="inline-flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50 hover:border-gray-400 transition">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 text-indigo-600" aria-hidden="true">
                <path d="M3.25 4A.75.75 0 0 1 4 3.25h12a.75.75 0 0 1 .53 1.28l-4.78 4.78v4.19a.75.75 0 0 1-.33.62l-2.5 1.67A.75.75 0 0 1 7.5 15.5V9.31L2.72 4.53A.75.75 0 0 1 3.25 4Z"/>
              </svg>
              Filters
              <span id="active-count" class="ml-1 hidden rounded-full bg-indigo-100 px-2 py-0.5 text-xs font-bold text-indigo-700">0</span>
            </button>
          </div>
        </div>

        <p id="eligible-pill" class="hidden text-sm text-gray-600 mb-2" aria-live="polite">
          <span id="eligible-extra" class="font-semibold"></span>
        </p>

        <!-- Selectable items as a list -->
        <ul id="selectable-items-container" class="flex flex-wrap gap-3" role="list">
          <!-- plan <li> injected here -->
        </ul>
      </section>

      <!-- Comparison table -->
      <section aria-labelledby="comparison-heading">
        <h2 id="comparison-heading" class="text-2xl font-bold text-center mb-6">Comparison</h2>
        <div id="comparison-table-container" class="bg-white rounded-xl shadow-lg overflow-x-auto">
          <!-- table injected here -->
        </div>
      </section>
    </main>

    <!-- Optional footer -->
    <footer class="sr-only">
      <p>End of comparison tool.</p>
    </footer>
  </div>

  <!-- Filters Modal as native dialog -->
  <dialog id="filter-dialog" class="w-full max-w-3xl rounded-2xl bg-white shadow-2xl border border-gray-200 p-0">
    <form method="dialog" class="flex flex-col max-h-[80vh]">
      <header class="p-5 border-b flex items-center justify-between">
        <h3 id="filter-title" class="text-lg font-semibold text-gray-900">Filter options</h3>
        <div class="flex items-center gap-2">
          <button type="button" id="clear-filters" class="text-sm font-semibold text-indigo-600 hover:text-indigo-800">Clear all</button>
          <button id="close-filters" class="inline-flex items-center rounded-lg border border-gray-300 bg-white px-3 py-1.5 text-sm font-semibold text-gray-700 hover:bg-gray-50">Close</button>
        </div>
      </header>

      <div class="p-5 grid grid-cols-1 md:grid-cols-2 gap-4 overflow-auto">
        <!-- Subscription -->
        <fieldset class="border rounded-lg p-3">
          <legend class="px-1 text-sm font-medium text-gray-600">Subscription</legend>
          <div class="mt-2 flex flex-wrap gap-2">
            <label class="flex items-center">
              <input type="checkbox" data-filter-group="subscription" value="Free" class="peer hidden" />
              <span class="cursor-pointer rounded-full border border-gray-300 px-3 py-1.5 text-sm text-gray-700 transition-colors peer-checked:bg-indigo-600 peer-checked:text-white peer-checked:border-indigo-600">Free</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" data-filter-group="subscription" value="Paid" class="peer hidden" />
              <span class="cursor-pointer rounded-full border border-gray-300 px-3 py-1.5 text-sm text-gray-700 transition-colors peer-checked:bg-indigo-600 peer-checked:text-white peer-checked:border-indigo-600">Paid</span>
            </label>
          </div>
        </fieldset>

        <!-- Audience -->
        <fieldset class="border rounded-lg p-3">
          <legend class="px-1 text-sm font-medium text-gray-600">Target audience</legend>
          <div class="mt-2 flex flex-wrap gap-2">
            <label class="flex items-center">
              <input type="checkbox" data-filter-group="audience" value="Personal" class="peer hidden" />
              <span class="cursor-pointer rounded-full border border-gray-300 px-3 py-1.5 text-sm text-gray-700 transition-colors peer-checked:bg-indigo-600 peer-checked:text-white peer-checked:border-indigo-600">Personal</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" data-filter-group="audience" value="Business" class="peer hidden" />
              <span class="cursor-pointer rounded-full border border-gray-300 px-3 py-1.5 text-sm text-gray-700 transition-colors peer-checked:bg-indigo-600 peer-checked:text-white peer-checked:border-indigo-600">Business</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" data-filter-group="audience" value="Enterprise" class="peer hidden" />
              <span class="cursor-pointer rounded-full border border-gray-300 px-3 py-1.5 text-sm text-gray-700 transition-colors peer-checked:bg-indigo-600 peer-checked:text-white peer-checked:border-indigo-600">Enterprise</span>
            </label>
          </div>
        </fieldset>

        <!-- Support -->
        <fieldset class="border rounded-lg p-3 md:col-span-2">
          <legend class="px-1 text-sm font-medium text-gray-600">Support level</legend>
          <div class="mt-2 flex flex-wrap gap-2">
            <label class="flex items-center">
              <input type="checkbox" data-filter-group="support" value="Community" class="peer hidden" />
              <span class="cursor-pointer rounded-full border border-gray-300 px-3 py-1.5 text-sm text-gray-700 transition-colors peer-checked:bg-indigo-600 peer-checked:text-white peer-checked:border-indigo-600">Community</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" data-filter-group="support" value="Email" class="peer hidden" />
              <span class="cursor-pointer rounded-full border border-gray-300 px-3 py-1.5 text-sm text-gray-700 transition-colors peer-checked:bg-indigo-600 peer-checked:text-white peer-checked:border-indigo-600">Email</span>
            </label>
            <label class="flex items-center">
              <input type="checkbox" data-filter-group="support" value="Dedicated" class="peer hidden" />
              <span class="cursor-pointer rounded-full border border-gray-300 px-3 py-1.5 text-sm text-gray-700 transition-colors peer-checked:bg-indigo-600 peer-checked:text-white peer-checked:border-indigo-600">Dedicated</span>
            </label>
          </div>
        </fieldset>
      </div>

      <footer class="p-5 border-t flex items-center justify-end gap-2">
        <button id="apply-filters" class="inline-flex items-center rounded-lg bg-indigo-600 text-white px-4 py-2 text-sm font-semibold hover:bg-indigo-700">Apply</button>
      </footer>
    </form>
  </dialog>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // --- DATA SOURCE ---
      const allItems = [
  {
    id: 1,
    name: 'ANTSA',
    link: { label: 'See more', url: 'https://www.antsa.com.au/' },
    appCompliance: true, // Australian Privacy Principles
    dataStorage: 'Australia',
    freeMembership: false,
    freeTrial: '30 days',
    pmsIntegration: 'AI scribe can save into any PMS; early stage, info changing. Contact help@ANTSA.com.au',
    uniqueFeatures: {
      sections: [
        {
          category: 'AI Scribe Integration',
          items: ['AI scribe (converts voice to text) exportable to PMS (coming January 2025)'],
        },
        {
          category: '24/7 AI Therapy',
          items: [
            'jAlmee AI therapy chatbot available 24/7',
            'Clinicians can observe jAlmee live or at next session',
            'AI interventions supervised by clinicians',
            'Practitioner oversight & customisability',
            'Continuous client engagement between sessions',
          ],
        },
      ],
    },
    coreFeatures: {
      sections: [
        {
          category: 'AI Transcription',
          items: ['AI scribe (no recordings; converts straight to notes) — Available January 2025'],
        },
        {
          category: 'Therapy Tools',
          items: [
            'Overseen AI therapy chatbot (jAlmee)',
            'Automated, fully customisable homework',
            'On-demand evidence-based psychoeducation library',
            'Journalling activities',
          ],
        },
        {
          category: 'Monitoring & Analytics',
          items: [
            'AI detects client distress in real time',
            'Mood tracking (graphed for clinician & client)',
            'Real-time data collection & monitoring',
            'Gamified engagement',
          ],
        },
        {
          category: 'Security & Communication',
          items: [
            'Secure client–practitioner communication',
            'Designed for clinician oversight',
            'Privacy & data security are top priority',
          ],
        },
      ],
    },
    pricing: {
      bullets: [
        '$59 per month for UNLIMITED clients, prompts, transcriptions',
        'Includes AI transcriptions, homework tasks, customisable activities, and continuous engagement with jAlmee',
        'Discounts for clinics with multiple licences',
        'Details: https://www.antsa.com.au/pricing-plans',
      ],
    },
    telehealth: true,
    headphonesCompatible: true,
    mobileCompatible: true,
    multipleNotes: 'Not sure',
    aiTrainableOverTime: true,
    contentTuning: true,
    trustedSourcesOnly: true,
    languagesSupported: {
      bullets: [
        'Not at this time; will add languages over time',
        'Contact help@ANTSA.com.au for requests',
      ],
    },
  },

  {
    id: 2,
    name: 'Bastion GPT',
    link: { label: '30 day free trial', url: 'https://buy.stripe.com/eVa8yH6Akcs35I48wQ' },
    appCompliance: true,
    dataStorage: 'Australia',
    freeMembership: false,
    freeTrial: '30 days',
    pmsIntegration: 'Copy + Paste typical, if needed',
    uniqueFeatures: {
      sections: [
        {
          category: 'Advanced Transcription',
          items: ['Transcription with speaker recognition included'],
        },
        {
          category: 'Specialized Healthcare AI',
          items: [
            'Models customized for 200+ healthcare & mental health use cases',
            'More evidence-based output vs generic models',
            'Access latest high-end models with one subscription; APP compliant',
            'Reduced content filters around sensitive psychology topics',
            'Searchable chat history',
          ],
        },
      ],
    },
    coreFeatures: {
      sections: [
        {
          category: 'AI Assistant',
          items: ['ChatGPT-like UX with psychology-tailored models and features'],
        },
        {
          category: 'Privacy & AI Models',
          items: [
            'APP/Privacy Act compliant with personal information',
            'Auto-select leading models (OpenAI GPT-4, Google Gemini, Anthropic Claude) based on task',
          ],
        },
      ],
    },
    pricing: {
      tiers: [
        { name: 'Professional', price: '$20/mo', notes: 'Psychology-tailored models; unlimited prompts; up to 10,000-word inputs' },
        { name: 'Professional Plus', price: '$45/mo', notes: 'More memory (up to 35,000 words), cloud-sync saved prompts, image/graphics processing' },
        { name: 'Enterprise', price: '$60/mo', notes: 'Customizable security policies, SSO' },
      ],
    },
    telehealth: true,
    headphonesCompatible: true,
    mobileCompatible: false,
    multipleNotes: true,
    aiTrainableOverTime: true,
    contentTuning: true,
    trustedSourcesOnly: true,
    languagesSupported: { bullets: ['English primarily supported', 'Content can be generated in many other languages'] },
  },

  {
    id: 3,
    name: 'Patient Notes',
    link: { label: '10% Discount', url: 'https://www.patientnotes.app/', code: 'AIPSYCH2024' },
    appCompliance: true,
    dataStorage: 'Australia',
    freeMembership: false,
    freeTrial: '14 days',
    pmsIntegration: 'Cliniko and Nookal',
    uniqueFeatures: {
      sections: [
        {
          category: 'Advanced Tools',
          items: ['Smart dictate', 'Multi session reports', 'Speech-to-text editing', 'Prompt creation tool', 'Extensive prompt library'],
        },
      ],
    },
    coreFeatures: {
      sections: [
        {
          category: 'Session Management',
          items: [
            'Create session data from audio for clinical notes (in rooms or telehealth)',
            'Generate reports/letters from captured session data or manual notes',
          ],
        },
        { category: 'Smart Features', items: ['Smart dictate for flexible admin (notes, letters, phone sessions)'] },
      ],
    },
    pricing: {
      tiers: [
        { name: 'Essential', price: '$29 AUD / $19 USD' },
        { name: 'Professional', price: '$79 AUD / $49 USD' },
      ],
      codes: [{ code: 'AIPSYCH2024', discount: '10% off' }],
    },
    telehealth: true,
    headphonesCompatible: false,
    mobileCompatible: true,
    multipleNotes: true,
    aiTrainableOverTime: 'Prompt review tool found better than training',
    contentTuning: true,
    trustedSourcesOnly: false,
    languagesSupported: [
      'Bulgarian', 'Catalan', 'Chinese (Mandarin, Simplified)', 'Chinese (Mandarin, Traditional)',
      'Chinese (Cantonese, Traditional)', 'Czech', 'Danish', 'Dutch', 'English Australian', 'English British',
      'English Indian', 'English New Zealand', 'English U.S.', 'Estonian', 'Finnish', 'Flemish', 'French Canadian',
      'French Swiss', 'French', 'German Swiss', 'German', 'Greek', 'Hindi', 'Hungarian', 'Indonesian', 'Italian',
      'Japanese', 'Korean', 'Latvian', 'Lithuanian', 'Malay', 'Spanish and English', 'Norwegian', 'Polish',
      'Portuguese Brazilian', 'Portuguese', 'Romanian', 'Russian', 'Slovak', 'Spanish', 'Swedish', 'Thai',
      'Turkish', 'Ukrainian', 'Vietnamese',
    ],
  },

  {
    id: 4,
    name: 'Heidi Health',
    link: { label: '30 day free trial', url: 'https://scribe.heidihealth.com/?via=psychologysquared' },
    appCompliance: true,
    dataStorage: 'Australian AWS servers',
    freeMembership: { available: true, note: 'Unlimited usage without being limited by number of actions' },
    freeTrial: '30 days',
    pmsIntegration: 'Cliniko, Best Practice, Medirecords; more coming. Contact Support@heidihealth.com',
    uniqueFeatures: {
      sections: [
        {
          category: 'Security & Compliance',
          items: ['Highest level of security (SOC2 and ISO27001)', 'Fully regulated in multiple countries'],
        },
        { category: 'Medical Specialization', items: ['AI trained on medical language, built by clinicians; transcription is unmatched'] },
      ],
    },
    coreFeatures: {
      sections: [
        { category: 'Documentation', items: ['Transcription', 'Document and note generation', 'Custom templates'] },
        {
          category: 'Integration & Support',
          items: ['Ask AI feature', 'PMS integrations', 'Team & enterprise infrastructure', 'Full Telehealth support', 'Heidi Health App'],
        },
      ],
    },
    pricing: {
      tiers: [
        { name: 'Free Tier', price: 'Free', notes: 'Access to AI scribe; 10 pro actions/month for custom templates, document generation, Ask Heidi' },
        { name: 'Pro Tier', price: '$99/mo or $799/yr', notes: 'Unlimited usage; self-serve templates or community templates' },
        { name: 'Together Tier', price: '$1299/yr per user', notes: 'Team features, PMS integration, full Heidi support (template creation by Medical Knowledge team)' },
      ],
    },
    telehealth: true,
    headphonesCompatible: true,
    mobileCompatible: true,
    multipleNotes: false,
    aiTrainableOverTime: false,
    contentTuning: true,
    trustedSourcesOnly: true,
    languagesSupported: [
      'Cantonese','Czech','Danish','Dutch','Flemish','French','German','Greek','Hindi','Indonesian','Italian','Mandarin',
      'Norwegian','Japanese','Korean','Malay','Polish','Portuguese','Russian','Spanish','Swedish','Thai','Turkish','Ukrainian','Vietnamese',
    ],
  },

  {
    id: 5,
    name: 'Lyrebird',
    link: { label: '10% Discount', url: 'https://www.lyrebirdhealth.com/us?via=024cf1', code: 'PS10' },
    appCompliance: true,
    dataStorage: 'Australia',
    freeMembership: true,
    freeTrial: '14 days',
    pmsIntegration: 'Best Practice (available) & Genie/Gentu (coming very soon)',
    uniqueFeatures: {
      sections: [
        {
          category: 'Customization',
          items: [
            'Deep customisation; upload an example ideal report to learn your style (Heidi Health claims similar feature)',
            'Avoid robotic tone; letters sound like you',
          ],
        },
        { category: 'Security', items: ['Processes all data on Australian soil'] },
      ],
    },
    coreFeatures: {
      sections: [{ category: 'AI Medical Scribe', items: ['Listens to consultation and converts to clinical notes and documents'] }],
    },
    pricing: {
      bullets: [
        'Standard: $300/mo OR $2,400/yr (33% discount)',
        'Code PS10 for 10% off',
        'Students: Free for 1 year',
        'Registrars: 80% off if solo; free if part of a clinic deal',
        'Part-Time: >25 hrs/wk full price; <25 hrs/wk 50% discount',
        'Organisations: Special pricing & onboarding for clinics',
      ],
    },
    telehealth: true,
    headphonesCompatible: true,
    mobileCompatible: true,
    multipleNotes: true,
    aiTrainableOverTime: true,
    contentTuning: true,
    trustedSourcesOnly: false,
    languagesSupported: 'Yes, it supports all languages',
  },

  {
    id: 6,
    name: 'Zanda Health',
    link: { label: 'See more', url: 'https://zandahealth.com/?fpr=david67' },
    appCompliance: true,
    dataStorage: 'Australia (For Aus users). Stored according to the practice\'s location',
    freeMembership: false,
    freeTrial: '14 days',
    pmsIntegration: 'Built natively within the Zanda practice management system',
    uniqueFeatures: {
      sections: [
        {
          category: 'Purpose-built',
          items: [
            'Built for psychologists and allied health professionals',
            'Custom note output preferences per user',
            'Seamless with Zanda client profile (no copy/paste)',
            'Refine tool free to apply AI changes',
            'Custom transcript retention period',
            'Usage report by user and date range',
            'Compliant with Australian privacy & security; ISO 27001 certified',
          ],
        },
      ],
    },
    coreFeatures: {
      sections: [
        {
          category: 'Transcription & Notes',
          items: [
            'Real-time transcription',
            'Add typed context during transcription',
            'Fully customisable note templates',
            'Per-user custom note preferences (formatting, style, more)',
            'Refine note using AI',
          ],
        },
      ],
    },
    pricing: 'AI Refine tool free for all users. Transcription billed at $1 + GST per hour (pro rata).',
    telehealth: { available: true, note: 'Yes with speaker mode; Zoom headphones option in progress' },
    headphonesCompatible: true,
    mobileCompatible: true,
    multipleNotes: 'Under development',
    aiTrainableOverTime: 'On roadmap',
    contentTuning: 'Users can provide preferences the tool abides by',
    trustedSourcesOnly: 'Achievable via user custom preferences',
    languagesSupported: 'Currently only available in English.',
  },

  {
    id: 7,
    name: 'NovoNote by NovoPsych',
    link: { label: 'See more', url: 'https://novopsych.com/novonote/' },
    appCompliance: true,
    dataStorage: 'Australia',
    freeMembership: true,
    freeTrial: '3 months',
    pmsIntegration: 'Copy/paste into PMS; integration with NovoPsych',
    uniqueFeatures: {
      sections: [
        {
          category: 'Designed for Mental Health',
          items: [
            'Built by the NovoPsych team for mental health practitioners',
            'Multi session reports (coming January 2025)',
            'Integration of NovoPsych psychometric results (coming January 2025)',
            'Template library by psychologists',
          ],
        },
      ],
    },
    coreFeatures: {
      sections: [
        {
          category: 'Documentation & Templates',
          items: [
            'In-session transcription',
            'Document and note generation',
            'Dictation of notes',
            'Mental health specific template library',
            'Custom templates',
          ],
        },
        {
          category: 'Integrations & Platform',
          items: ['Integration with NovoPsych Psychometrics', 'Practice Plans for teams', 'Telehealth support', 'Works on computers, phones and tablets'],
        },
      ],
    },
    pricing: {
      bullets: [
        'All plans include access to NovoPsych Psychometrics',
        'Free: 30 notes/month',
        'Pro: $25 — 50 notes/month',
        'Pro Plus: $60 — 100 notes/month',
        'Platinum: $99 — Unlimited usage',
        'Practice Plans starting from $50 per clinician/month',
      ],
    },
    telehealth: true,
    headphonesCompatible: 'Not sure',
    mobileCompatible: false,
    multipleNotes: true,
    aiTrainableOverTime: true,
    contentTuning: true,
    trustedSourcesOnly: true,
    languagesSupported: 'Primarily English',
  },

  {
    id: 8,
    name: 'Uplift AI',
    link: { label: 'See more', url: 'https://www.upliftgroup.ai/' },
    appCompliance: true,
    dataStorage: 'Australia',
    freeMembership: true,
    freeTrial: 'Ongoing for now',
    pmsIntegration: 'Standalone AI-powered all-inclusive PMS or alongside existing PMS',
    uniqueFeatures: {
      sections: [
        {
          category: 'Inclusive Operating System',
          items: ['Fully inclusive AI-driven operating system combining AI therapy, practice management, and patient engagement'],
        },
      ],
    },
    coreFeatures: {
      sections: [
        {
          category: 'AI-Powered',
          items: [
            'Scheduling, billing, workflow automation',
            'Clinical notes, session summaries, treatment plans, reports, diagnoses',
            'Patient risk alerts & insights',
            'Therapy support between sessions to reduce dropout and maintain engagement',
          ],
        },
      ],
    },
    pricing: 'Free. Future pricing packages to be determined end 2025/start 2026',
    telehealth: true,
    headphonesCompatible: true,
    mobileCompatible: true,
    multipleNotes: 'Standalone all-inclusive PMS or alongside existing PMS',
    aiTrainableOverTime: true,
    contentTuning: true,
    trustedSourcesOnly: true,
    languagesSupported: 'Not currently. It will in future development.',
  },

  {
    id: 9,
    name: 'Everbility',
    link: { label: '10% Discount', url: 'https://www.everbility.com/?via=david-lopis' },
    appCompliance: true,
    dataStorage: 'Australia',
    freeMembership: false,
    freeTrial: '7 days',
    pmsIntegration: 'Building integrations with many Australian PMS; contact for your PMS',
    uniqueFeatures: {
      sections: [
        {
          category: 'Long-form capability',
          items: [
            'Can write very long reports from extensive context',
            'Find peer-reviewed research',
            'Additional NDIS knowledge',
            'Upload PDFs (including handwriting)',
          ],
        },
        { category: 'Support', items: ['Unlimited customer support, including template creation'] },
      ],
    },
    coreFeatures: {
      sections: [
        {
          category: 'Clinical documentation',
          items: [
            'Supports any amount of context to write detailed documentation',
            'Transcribe and generate notes from transcription',
            'Use historical info and extensive context to generate very detailed reports',
          ],
        },
      ],
    },
    pricing: {
      bullets: [
        '$50 AUD/month per clinician or $420 AUD/year per clinician (≈30% discount)',
        'No additional costs for template support, training calls, etc.',
      ],
    },
    telehealth: true,
    headphonesCompatible: true,
    mobileCompatible: true,
    multipleNotes: true,
    aiTrainableOverTime: true,
    contentTuning: true,
    trustedSourcesOnly: true,
    languagesSupported: { bullets: ['Can be used in many other languages', 'Contact support if you have issues'] },
  },
];


      const MAX_COMPARE_ITEMS = 3;

      // --- STATE ---
      let activeFilters = { subscription: [], audience: [], support: [] };
      let comparedItemIds = [];

      // --- DOM ---
      const filterBtn = document.getElementById('filter-btn');
      const filterDialog = document.getElementById('filter-dialog');
      const clearFiltersBtn = document.getElementById('clear-filters');
      const closeFiltersBtn = document.getElementById('close-filters');
      const applyFiltersBtn = document.getElementById('apply-filters');
      const activeCount = document.getElementById('active-count');
      const chipsWrap = document.getElementById('active-chips');

      const selectableItemsContainer = document.getElementById('selectable-items-container');
      const comparisonTableContainer = document.getElementById('comparison-table-container');
      const matchCountEl = document.getElementById('match-count');
      const matchPill = document.getElementById('match-pill');
      const eligiblePill = document.getElementById('eligible-pill');
      const eligibleExtra = document.getElementById('eligible-extra');

      // --- MODAL helpers (native dialog) ---
      const openModal = () => {
        filterDialog.showModal();
        filterBtn.setAttribute('aria-expanded','true');
      };
      const closeModal = () => {
        filterDialog.close();
        filterBtn.setAttribute('aria-expanded','false');
      };
      filterBtn.addEventListener('click', openModal);
      closeFiltersBtn.addEventListener('click', (e)=>{ e.preventDefault(); closeModal(); });
      applyFiltersBtn.addEventListener('click', (e)=>{ e.preventDefault(); closeModal(); });

      // Close on backdrop click
      filterDialog.addEventListener('click', (event) => {
        const rect = filterDialog.getBoundingClientRect();
        const inDialog = (
          event.clientX >= rect.left &&
          event.clientX <= rect.right &&
          event.clientY >= rect.top &&
          event.clientY <= rect.bottom
        );
        if (!inDialog) closeModal();
      });

      // --- RENDERERS ---
      const renderActiveChips = () => {
        chipsWrap.innerHTML = '';
        const entries = Object.entries(activeFilters).flatMap(([group, values]) => values.map(v => ({group, value:v})));
        activeCount.textContent = entries.length;
        activeCount.classList.toggle('hidden', entries.length===0);

        entries.forEach(({group, value}) => {
          const li = document.createElement('li');
          const chip = document.createElement('button');
          chip.type = 'button';
          chip.className = 'inline-flex items-center gap-1 rounded-full bg-gray-100 border border-gray-200 px-3 py-1 text-sm text-gray-700 hover:bg-gray-200';
          chip.innerHTML = `${value}<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-4 w-4" aria-hidden="true"><path d="M6.28 5.22a.75.75 0 1 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 1 0-1.06-1.06L10 8.94 6.28 5.22Z"/></svg>`;
          chip.setAttribute('aria-label', `Remove filter ${value}`);
          chip.addEventListener('click', ()=>{
            activeFilters[group] = activeFilters[group].filter(x => x!==value);
            const selector = `input[data-filter-group="${group}"][value="${value}"]`;
            const input = filterDialog.querySelector(selector);
            if (input) input.checked = false;
            update();
          });
          li.appendChild(chip);
          chipsWrap.appendChild(li);
        });
      };

      const renderSelectableItems = () => {
        const filtered = getFilteredItems();
        selectableItemsContainer.innerHTML = '';

        matchCountEl.textContent = filtered.length;
        matchPill.classList.remove('hidden');

        const overflow = Math.max(0, filtered.length - comparedItemIds.length);
        eligiblePill.classList.toggle('hidden', overflow <= MAX_COMPARE_ITEMS);
        
        if (filtered.length === 0) {
          const li = document.createElement('li');
          li.className = 'text-gray-500 w-full text-center py-8';
          li.textContent = 'No plans match your criteria. Try adjusting the filters.';
          selectableItemsContainer.appendChild(li);
          return;
        }

        filtered.forEach(item => {
          const isCompared = comparedItemIds.includes(item.id);
          const atLimit = comparedItemIds.length >= MAX_COMPARE_ITEMS;

          const li = document.createElement('li');
          li.className = 'flex';

          const btn = document.createElement('button');
          btn.type = 'button';
          btn.dataset.id = item.id;
          btn.setAttribute('aria-pressed', String(isCompared));
          btn.setAttribute('aria-label', `${isCompared ? 'Remove' : 'Add'} ${item.name} ${isCompared ? 'from' : 'to'} comparison`);

          let cls = 'add-to-compare-btn flex items-center gap-2 rounded-lg font-semibold text-sm transition-all-smooth px-4 py-2 border ';
          let label = item.name;

          if (isCompared) {
            cls += 'bg-indigo-600 text-white border-indigo-600';
            btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true"><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/></svg>${label}`;
          } else if (atLimit) {
            cls += 'bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed';
            btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/><path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/></svg>${label}`;
            btn.disabled = true;
          } else {
            cls += 'bg-white text-gray-700 border-gray-300 hover:bg-gray-100 hover:border-gray-400';
            btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/><path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/></svg>${label}`;
          }

          btn.className = cls;
          li.appendChild(btn);
          selectableItemsContainer.appendChild(li);
        });
      };

      const renderComparisonTable = () => {
        if (comparedItemIds.length === 0) {
          comparisonTableContainer.innerHTML = `
            <div class="comparison-placeholder flex items-center justify-center rounded-xl p-8" role="status" aria-live="polite">
              <p class="text-center">Add up to 3 plans from the list above to compare them.</p>
            </div>`;
          return;
        }

        const items = allItems.filter(i => comparedItemIds.includes(i.id));
        const fields = ['price','subscription','audience','support','storage','users','analytics','integrations'];
        const headers = items.map(i => i.name);
        const rows = fields.map(f => {
                const label = f.replace('_',' ');
                const row = items.map(it => {
                  let v = it[f];
                  if (f === 'price') v = v>0 ? `$${v}/mo` : 'Free';
                  return `<td class="text-center px-6 py-3 border-t">${v}</td>`;
                }).join('');
                return `
                  <tr role="row">
                    <th scope="row" class="text-left font-semibold capitalize px-6 py-3 border-t">${label}</th>
                    ${row}
                  </tr>`;
                });

        // Build semantic table
        let html = `
          <table class="min-w-full text-sm" role="table">
            <caption class="sr-only">Feature comparison of selected plans</caption>
            <thead class="sticky-header">
              <tr role="row">
                <th scope="col" class="text-left font-bold text-lg px-6 py-4">Feature</th>
                ${headers.map(h => `<th scope="col" class="text-center font-bold text-lg px-6 py-4 text-indigo-600">${h}</th>`).join('')}
              </tr>
            </thead>
            <tbody>
              ${rows.join('')}
            </tbody>
          </table>
        `;
        comparisonTableContainer.innerHTML = html;
      };

      // --- FILTER LOGIC ---
      const getFilteredItems = () => {
        const hasFilters = Object.values(activeFilters).some(arr => arr.length);
        if (!hasFilters) return allItems;
        return allItems.filter(item =>
          Object.entries(activeFilters).every(([group, values]) =>
            !values.length || values.includes(item[group])
          )
        );
      };

      const update = () => { renderActiveChips(); renderSelectableItems(); renderComparisonTable(); };

      // --- EVENTS ---
      filterDialog.addEventListener('change', e => {
        if (e.target.matches('input[type="checkbox"]')){
          const g = e.target.dataset.filterGroup; const val = e.target.value;
          if (e.target.checked){ if (!activeFilters[g].includes(val)) activeFilters[g].push(val); }
          else { activeFilters[g] = activeFilters[g].filter(v => v!==val); }
          update();
        }
      });

      clearFiltersBtn.addEventListener('click', (e) => {
        e.preventDefault();
        filterDialog.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
        activeFilters = { subscription: [], audience: [], support: [] };
        update();
      });

      selectableItemsContainer.addEventListener('click', e => {
        const btn = e.target.closest('.add-to-compare-btn');
        if (!btn) return;
        const id = parseInt(btn.dataset.id, 10);
        const isSelected = comparedItemIds.includes(id);
        const atLimit = comparedItemIds.length >= MAX_COMPARE_ITEMS;

        if (isSelected){
          comparedItemIds = comparedItemIds.filter(x => x!==id);
        } else if (!atLimit){
          comparedItemIds.push(id);
        }
        // reflect pressed state for a11y
        btn.setAttribute('aria-pressed', String(!isSelected));
        update();
      });

      // INIT
      update();
    });
  </script>
</body>
</html>
